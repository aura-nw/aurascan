<div *ngIf="loading" class="m-auto mt-10">
  <app-loading-sprint></app-loading-sprint>
</div>

<ng-container *ngIf="nftDetail && nftDetail.type === contractType.CW721">
  <div class="text--white">
    <div class="d-lg-none">
      <h1 class="fw-semibold mb-0 text--white d-flex align-items-center flex-wrap">
        <ng-container *ngIf="!nftDetail?.isDisplayName">
          <span class="mr-1">{{ nftDetail?.name || nftDetail?.token_name }}</span>
          <span class="mr-2">#{{ nftDetail?.token_id | ellipsis: 8 : 8 }}</span>
        </ng-container>
        <ng-container *ngIf="nftDetail?.isDisplayName"> {{ nftDetail?.nftName }} </ng-container>
        <button class="button btn-share" *ngIf="!nftDetail?.burned" (click)="shareNFT()">
          <img [src]="'assets/icons/icons-svg/white/share.svg' | imageS3" alt="" width="40" height="40" />
        </button>
        <span class="burnt-tag caption" *ngIf="nftDetail?.burned">Burnt</span>
      </h1>
      <div class="mt-2">
        <a class="text--primary h6 mb-0 mt-2" [routerLink]="['/tokens/' + linkToken, nftDetail?.contract_address]">{{
          nftDetail?.name || nftDetail?.token_name
        }}</a>
      </div>
    </div>

    <div class="row p-lg-3">
      <!-- nft-media -->
      <div class="col-12 col-lg-4 my-4 my-md-0 pl-lg-0">
        <div class="nft-img__contain w-100 h-100">
          <div class="card m-0 w-100 h-100 align-items-center justify-content-center"></div>
        </div>
      </div>
      <div class="col-12 col-lg-8 pl-lg-3">
        <div class="d-lg-flex flex-column h-100">
          <div class="d-lg-flex justify-content-between">
            <div class="d-flex align-items-center d-lg-flex d-none">
              <h1 class="fw-bold sub-text text--white mb-0 mr-1">
                <ng-container *ngIf="!nftDetail?.isDisplayName">
                  {{ nftDetail?.name || nftDetail?.token_name }} #{{ nftDetail?.token_id | ellipsis: 8 : 8 }}
                </ng-container>
                <ng-container *ngIf="nftDetail?.isDisplayName"> {{ nftDetail?.nftName }} </ng-container>
              </h1>
              <button class="button btn-share" *ngIf="!nftDetail?.burned" (click)="shareNFT()">
                <img [src]="'assets/icons/icons-svg/white/share.svg' | imageS3" alt="" width="40" height="40" />
              </button>
              <span class="burnt-tag" *ngIf="nftDetail?.burned">Burnt</span>
            </div>
          </div>
          <div class="mt-1 mt-lg-2 mb-4 d-lg-flex d-none">
            <a
              class="body-01 text--primary break-word"
              [routerLink]="['/tokens/' + linkToken, nftDetail?.contract_address]"
              >{{ nftDetail?.name || nftDetail?.token_name }}</a
            >
          </div>
          <!-- Desktop card info -->
          <div class="d-none d-lg-block card py-3 px-6" *ngIf="false">
            <div class="d-flex">
              <div class="flex-shrink-0 flex-grow-1 w-auto">
                <div class="body-01 text--gray-5 mb-1">Min. Price</div>
                <div class="h3 mb-0 text--white">
                  <span>- {{ denom }}</span>
                  <span class="text--gray-5 ml-2">(-)</span>
                </div>
              </div>
              <div class="flex-shrink-0 flex-grow-1 w-auto">
                <div class="divider divider-vertical"></div>
              </div>
              <div class="flex-shrink-0 flex-grow-1 w-auto">
                <div class="body-01 text--gray-5 mb-1">Last Sale (Item)</div>
                <div class="h3 mb-0 text--white">
                  <span>N/A</span>
                  <!--              <span class="text--gray-5 ml-2">($32.42)</span>-->
                </div>
              </div>
              <div class="flex-shrink-0 flex-grow-1 w-auto">
                <div class="divider divider-vertical"></div>
              </div>
              <div class="flex-shrink-0 flex-grow-1 w-auto">
                <div class="body-01 text--gray-5 mb-1">Last Sale (Contract)</div>
                <div class="h3 mb-0 text--white">
                  <span>- {{ denom }}</span>
                  <span class="text--gray-5 ml-2">(-)</span>
                </div>
              </div>
            </div>
          </div>
          <!-- Mobile card info -->
          <!-- End card info -->
          <div class="card card__ntf-detail mb-0">
            <h2 class="mb-0 h5-mob text--white card__ntf-detail-item" id="popupCopy">Details</h2>
            <div class="card__ntf-detail-item body">
              <div class="label-detail text--gray-5">Owner:</div>
              <div class="d-flex align-items-center position-relative" *ngIf="nftDetail?.owner && !nftDetail?.burned">
                <app-name-tag
                  [value]="nftDetail?.owner"
                  [fullText]="true"
                  [widthAuto]="true"
                  [url]="nftDetail?.owner?.length > lengthNormalAddress ? 'contracts' : 'account'"
                  [maxCharacter]="11"></app-name-tag>
                <div class="aura-tooltip-contain">
                  <button
                    class="button button--xxs aura-tooltip-object disabled-hover"
                    #tooltip
                    (click)="commonService.showToolTip(tooltip)"
                    [cdkCopyToClipboard]="nftDetail?.owner">
                    <img
                      [src]="'assets/icons/icons-svg/basic/copy.svg' | imageS3"
                      class="cursor-pointer btn-copy"
                      alt="" />
                  </button>
                  <app-tooltip-customize [content]="'Copied!'"></app-tooltip-customize>
                </div>
              </div>
            </div>
            <div class="card__ntf-detail-item body">
              <div class="label-detail text--gray-5">Contract Address:</div>
              <div class="d-flex align-items-center position-relative">
                <app-name-tag
                  [value]="nftDetail?.contract_address"
                  [url]="'contracts'"
                  [fullText]="true"
                  [widthAuto]="true"
                  [iconVerify]="nftDetail['verification_status'] === ContractVerifyType.Verified"
                  [maxCharacter]="11"></app-name-tag>
                <div class="aura-tooltip-contain">
                  <button
                    class="button button--xxs aura-tooltip-object disabled-hover"
                    #tooltip
                    (click)="commonService.showToolTip(tooltip)"
                    [cdkCopyToClipboard]="nftDetail?.contract_address">
                    <img
                      [src]="'assets/icons/icons-svg/basic/copy.svg' | imageS3"
                      class="cursor-pointer btn-copy"
                      alt="" />
                  </button>
                  <app-tooltip-customize [content]="'Copied!'"></app-tooltip-customize>
                </div>
              </div>
            </div>
            <div class="card__ntf-detail-item body">
              <div class="label-detail text--gray-5">Creator:</div>
              <div class="d-flex align-items-center">
                <app-name-tag
                  [value]="nftDetail?.creator"
                  [fullText]="true"
                  [widthAuto]="true"
                  [url]="nftDetail?.creator?.length > lengthNormalAddress ? 'contracts' : 'account'"
                  [maxCharacter]="11"></app-name-tag>
                <div class="aura-tooltip-contain">
                  <button
                    class="button button--xxs aura-tooltip-object disabled-hover"
                    #tooltipcreator
                    (click)="commonService.showToolTip(tooltipcreator)"
                    [cdkCopyToClipboard]="nftDetail?.creator">
                    <img
                      [src]="'assets/icons/icons-svg/basic/copy.svg' | imageS3"
                      class="cursor-pointer btn-copy"
                      alt="" />
                  </button>
                  <app-tooltip-customize [content]="'Copied!'"></app-tooltip-customize>
                </div>
              </div>
            </div>
            <div class="card__ntf-detail-item body">
              <div class="label-detail text--gray-5">Token ID:</div>
              <div class="d-flex align-items-center">
                <div class="text--gray-1 fw-normal-mob">
                  <span class="d-lg-flex d-none">
                    {{ nftDetail?.token_id }}
                  </span>
                  <span class="d-lg-none d-flex">
                    {{ nftDetail?.token_id | ellipsis: 10 }}
                  </span>
                </div>
                <div class="aura-tooltip-contain">
                  <button
                    class="button button--xxs aura-tooltip-object disabled-hover"
                    #tooltipId
                    (click)="commonService.showToolTip(tooltipId)"
                    [cdkCopyToClipboard]="nftDetail?.token_id">
                    <img
                      [src]="'assets/icons/icons-svg/basic/copy.svg' | imageS3"
                      class="ml-2 cursor-pointer btn-copy"
                      alt="" />
                  </button>
                  <app-tooltip-customize [content]="'Copied!'"></app-tooltip-customize>
                </div>
              </div>
            </div>
            <div class="card__ntf-detail-item body">
              <div class="label-detail text--gray-5">Token Standard:</div>
              <div class="text--gray-1 fw-normal-mob">
                {{ 'CW-721' }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card card-body mt-4 mt-lg-6">
    <h2 class="text--white mb-0">Item Activity</h2>

    <div class="divider divider-horizontal d-none d-lg-block mt-2"></div>
    <div class="text--gray-5 body-02 caption-mob fw-normal-mob mt-3 mb-2 mb-lg-3">
      A total of {{ pageData?.length | number }} record{{ pageData?.length > 1 ? 's' : '' }} found
    </div>
    <div class="overflow-scroll-x aura-table-contain" style="max-height: 600px">
      <app-loading-sprint *ngIf="loadingTable" class="m-auto mt-10"></app-loading-sprint>
      <app-table-no-data
        *ngIf="!loadingTable && errTxtActivity"
        class="mt-10"
        [textNull]="errTxtActivity"></app-table-no-data>
      <table
        *ngIf="dataSource?.data?.length > 0; else noValues"
        mat-table
        [dataSource]="dataSource"
        class="aura-table nft-detail-table keep-header">
        <ng-container *ngFor="let template of templates; index as i">
          <ng-container [matColumnDef]="template.matColumnDef">
            <th mat-header-cell *matHeaderCellDef>
              <div [innerHTML]="template.headerCellDef | translate"></div>
            </th>

            <td mat-cell *matCellDef="let data; let i = index">
              <ng-container [ngSwitch]="template.matColumnDef">
                <ng-container *ngSwitchCase="'tx_hash'">
                  <a class="text--primary" [routerLink]="['/transaction', data.tx_hash]">
                    {{ data[template.matColumnDef] | ellipsis: 8 : 8 }}
                  </a>
                </ng-container>
                <ng-container *ngSwitchCase="'status'">
                  <div [ngSwitch]="data[template.matColumnDef]" class="text-uppercase">
                    <div *ngSwitchCase="'Success'" class="text--green-3">
                      {{ data[template.matColumnDef] }}
                    </div>
                    <div *ngSwitchCase="'Fail'" class="text--red-3">
                      {{ data[template.matColumnDef] }}
                    </div>
                    <div *ngSwitchCase="'Pending'" class="text--yellow-3">
                      {{ data[template.matColumnDef] }}
                    </div>
                  </div>
                </ng-container>
                <ng-container *ngSwitchCase="'timestamp'">
                  {{ (data[template.matColumnDef] | dateCustom)[0] }}
                </ng-container>
                <ng-container *ngSwitchCase="'type'">
                  <div class="aura-status text-capitalize">
                    <span class="status">{{ data[template.matColumnDef] }}</span>
                  </div>
                </ng-container>
                <ng-container *ngSwitchCase="'from_address'">
                  <div class="content-transfer">
                    <ng-container
                      *ngIf="
                        data.modeExecute === modeExecuteTransaction.Take ||
                        data[template.matColumnDef]?.startsWith('Null')
                      ">
                      <span>{{ data[template.matColumnDef] | ellipsis: 8 : 8 }}</span>
                    </ng-container>
                    <ng-container
                      *ngIf="
                        data.modeExecute !== modeExecuteTransaction.Take &&
                        !data[template.matColumnDef]?.startsWith('Null')
                      ">
                      <app-name-tag
                        [value]="data[template.matColumnDef]"
                        [isTokenDetail]="true"
                        *ngIf="
                          data.modeExecute !== modeExecuteTransaction.Mint && data[template.matColumnDef]
                        "></app-name-tag>
                      <app-name-tag
                        [value]="data[template.matColumnDef]"
                        [isTokenDetail]="true"
                        *ngIf="data.modeExecute === modeExecuteTransaction.Mint"
                        [isLink]="false"></app-name-tag>
                    </ng-container>
                  </div>
                  <span *ngIf="!data[template.matColumnDef]"> - </span>
                  <img
                    [src]="'assets/images/icons/arrow-right.png' | imageS3"
                    width="14"
                    height="9"
                    class="ml-10 ml-lg-15" />
                </ng-container>
                <ng-container *ngSwitchCase="'to_address'">
                  <ng-container
                    *ngIf="
                      data.modeExecute === modeExecuteTransaction.Take ||
                      data[template.matColumnDef]?.startsWith('Null')
                    ">
                    <span>{{ data[template.matColumnDef] | ellipsis: 8 : 8 }}</span>
                  </ng-container>
                  <ng-container *ngIf="!data[template.matColumnDef]?.startsWith('Null')">
                    <app-name-tag
                      [url]="data[template.matColumnDef]?.length > lengthNormalAddress ? '/contracts' : '/account'"
                      [value]="data[template.matColumnDef]"
                      [type]="data.type"
                      [isTokenDetail]="true"
                      *ngIf="
                        data.modeExecute !== modeExecuteTransaction.Burn &&
                        data.modeExecute !== modeExecuteTransaction.UnEquip &&
                        data[template.matColumnDef]
                      "></app-name-tag>
                  </ng-container>
                </ng-container>
                <ng-container *ngSwitchCase="'price'">
                  <div class="aura-tooltip-contain d-flex" *ngIf="data[template.matColumnDef]">
                    <div class="aura-tooltip-object" *ngIf="data[template.matColumnDef] < 0.001"><0.001</div>
                    <div
                      [class.aura-tooltip-object]="data[template.matColumnDef] !== 0"
                      [class.cursor-text]="data[template.matColumnDef] < 1000000"
                      *ngIf="data[template.matColumnDef] >= 0.001"
                      [appBigNumber]="data[template.matColumnDef]"
                      [decimal]="0"></div>
                    <span [class.text--primary]="data.denom !== denom" class="ml-1">{{ data.denom || denom }}</span>
                    <app-tooltip-customize
                      *ngIf="data[template.matColumnDef] < 0.001 || data[template.matColumnDef] >= 1000000"
                      [content]="data[template.matColumnDef] | mask: 'separator.6'">
                    </app-tooltip-customize>
                  </div>
                  <div *ngIf="!data[template.matColumnDef]">-</div>
                </ng-container>
                <div *ngSwitchDefault>{{ data[template.matColumnDef] }}</div>
              </ng-container>
            </td>
          </ng-container>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell g-no-data pt-8" colspan="9999">
            <app-loading-sprint></app-loading-sprint>
          </td>
        </tr>
      </table>
    </div>
    <ng-template #noValues></ng-template>
  </div>
</ng-container>

<app-table-no-data *ngIf="!loading && errTxt" class="mt-20" [textNull]="errTxt"></app-table-no-data>
