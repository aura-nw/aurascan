<ng-container *ngIf="!loading">
  <div *ngIf="nextKey" class="body-03 caption-mob fw-normal-mob text--gray-5 mb-lg-3">
    More than {{ pageData?.length | number }} transaction{{ pageData?.length > 1 ? 's' : '' }} found
  </div>
  <div *ngIf="!nextKey" class="body-03 caption-mob fw-normal-mob text--gray-5 mb-lg-3">
    A total of {{ pageData?.length | number }} transaction{{ pageData?.length > 1 ? 's' : '' }} found
  </div>
  <div *ngIf="pageData?.length > 0" class="divider divider-horizontal my-4 d-lg-none"></div>
  <div class="transfer-table-container overflow-scroll-x">
    <ng-container *ngIf="pageData?.length > 0; else noValues">
      <table mat-table [dataSource]="dataSource" class="aura-table">
        <ng-container *ngFor="let template of template; index as i">
          <ng-container [matColumnDef]="template.matColumnDef" [ngSwitch]="template.matColumnDef">
            <ng-container *ngSwitchCase="'type'">
              <th mat-header-cell *matHeaderCellDef class="col-per-13">
                <div [innerHTML]="template.headerCellDef | translate" class="ml-5"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'tx_hash'">
              <th mat-header-cell *matHeaderCellDef class="col-per-15">
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'action'">
              <th mat-header-cell *matHeaderCellDef class="col-per-5">
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'from_address'">
              <th mat-header-cell *matHeaderCellDef>
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'to_address'">
              <th mat-header-cell *matHeaderCellDef>
                <div [innerHTML]="template.headerCellDef | translate" class="pl-4 pl-lg-0"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'details'">
              <th mat-header-cell *matHeaderCellDef class="col-per-15">
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchCase="'timestamp'">
              <th mat-header-cell *matHeaderCellDef class="col-per-15">
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>
            <ng-container *ngSwitchDefault>
              <th mat-header-cell *matHeaderCellDef class="col-per-13">
                <div [innerHTML]="template.headerCellDef | translate"></div>
              </th>
            </ng-container>

            <td mat-cell *matCellDef="let data">
              <div [classList]="[template.cssClass]">
                <ng-container *ngIf="template.isUrl && !template.isShort && data[template.matColumnDef]">
                  <a [routerLink]="[template.isUrl, data[template.paramField] || data[template.matColumnDef]]">
                    {{
                      (template.isShort ? shortenAddress(data[template.matColumnDef]) : data[template.matColumnDef]) ||
                        '-'
                    }}
                  </a>
                </ng-container>
                <ng-container *ngIf="template.isUrl && template.isShort">
                  <a
                    [routerLink]="[template.isUrl, data[template.matColumnDef]]"
                    [class.disabled-link]="!data[template.matColumnDef]">
                    {{ shortenAddress(data[template.matColumnDef]) || '-' }}
                  </a>
                </ng-container>
                <ng-container *ngIf="!template.isUrl || data[template.matColumnDef] === ''">
                  <ng-container [ngSwitch]="template.matColumnDef">
                    <ng-container *ngSwitchCase="'amountToken'">
                      <div class="aura-tooltip-contain">
                        <div
                          class="aura-tooltip-object"
                          *ngIf="(data.arrEvent[0]?.amountTemp | balanceOf : data.arrEvent[0]?.decimal) < 0.001">
                          <0,001
                        </div>
                        <app-tooltip-customize
                          [content]="data.arrEvent[0]?.amountTemp | convertSmallNumber : data.arrEvent[0]?.decimal">
                        </app-tooltip-customize>
                        <div
                          *ngIf="(data.arrEvent[0]?.amountTemp | balanceOf: data.arrEvent[0]?.decimal) >= 0.001"
                          [appBigNumber]="data.arrEvent[0]?.amountTemp"
                          [decimal]="data.arrEvent[0]?.decimal"></div>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'status'">
                      <div [ngSwitch]="data[template.matColumnDef]" class="text-uppercase">
                        <div *ngSwitchCase="'Success'" class="text--green-3">
                          {{ data[template.matColumnDef] }}
                        </div>
                        <div *ngSwitchCase="'Fail'" class="text--red-3">
                          {{ data[template.matColumnDef] }}
                        </div>
                        <div *ngSwitchCase="'Pending'" class="text--yellow-3">
                          {{ data[template.matColumnDef] }}
                        </div>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'timestamp'">
                      {{ commonService.getDateValue(data[template.matColumnDef])[0] }}
                    </ng-container>
                    <ng-container *ngSwitchCase="'type'">
                      <div class="aura-status text-capitalize">
                        <span class="status">{{ data[template.matColumnDef] }}</span>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'tx_hash'">
                      <a class="text--primary" [routerLink]="['/transaction', data.tx_hash]">
                        {{ data[template.matColumnDef] | cutStringPipe : 8 : 8 }}
                      </a>
                    </ng-container>
                    <ng-container *ngSwitchCase="'from_address'">
                      <div class="d-flex align-items-center">
                        <div class="content-transfer">
                          <ng-container
                            *ngIf="
                              data.modeExecute === modeExecuteTransaction.Take ||
                              data[template.matColumnDef]?.startsWith('Null')
                            ">
                            <span>{{ data[template.matColumnDef] | cutStringPipe : 8 : 8 }}</span>
                          </ng-container>
                          <ng-container
                            *ngIf="
                              data.modeExecute !== modeExecuteTransaction.Take &&
                              !data[template.matColumnDef]?.startsWith('Null')
                            ">
                            <app-name-tag
                              [value]="data[template.matColumnDef]"
                              [isHref]="true"
                              [url]="'/tokens/' + linkToken + '/' + contractAddress + '?a='"
                              [isTokenDetail]="true"
                              *ngIf="
                                data.modeExecute !== modeExecuteTransaction.Mint && data[template.matColumnDef]
                              "></app-name-tag>
                          </ng-container>
                        </div>
                        <ng-container *ngIf="!isSearchAddress">
                          <img
                            [src]="'assets/images/icons/arrow-right.png' | imageS3"
                            width="14"
                            height="9"
                            class="mr-lg-3 mr-0 ml-3 ml-lg-0" />
                        </ng-container>
                        <ng-container *ngIf="isSearchAddress">
                          <div class="box-token-transfer">
                            <span
                              class="token-transfer-status d-flex"
                              [ngClass]="{ 'status-out': data.from_address === keyWord }">
                              <ng-container *ngIf="data.from_address !== keyWord"> IN </ng-container>
                              <ng-container *ngIf="data.from_address === keyWord"> OUT </ng-container>
                            </span>
                          </div>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'to_address'">
                      <div class="pl-4 pl-lg-0" [style.min-width]="'200px'">
                        <app-name-tag
                          [value]="data[template.matColumnDef]"
                          [isHref]="true"
                          [isTokenDetail]="true"
                          [url]="'/tokens/' + linkToken + '/' + contractAddress + '?a='"
                          [type]="data.type"
                          *ngIf="
                            !data[template.matColumnDef]?.startsWith('Null') && data[template.matColumnDef]
                          "></app-name-tag>
                        <app-name-tag
                          [value]="data[template.matColumnDef]"
                          [isLink]="false"
                          [isTokenDetail]="true"
                          *ngIf="data[template.matColumnDef]?.startsWith('Null')"></app-name-tag>
                        <span *ngIf="!data[template.matColumnDef]"> - </span>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'details'">
                      <button
                        class="button button--sm button-outline button-outline--gradient button-outline__in-card button-pill"
                        [disabled]="
                          !data.token_id ||
                          data['status'] === 'Fail' ||
                          data['token_id'] === 'More' ||
                          data.modeExecute === modeExecuteTransaction.UnEquip ||
                          data['to_address']?.startsWith('Null')
                        "
                        [routerLink]="['/tokens/' + linkToken, contractAddress, data.token_id]">
                        <span *ngIf="typeContract === contractType.CW721">View NFT</span>
                        <span *ngIf="typeContract === contractType.CW4973">View ABT</span>
                      </button>
                    </ng-container>
                    <ng-container *ngSwitchCase="'token_id'">
                      <span *ngIf="data['token_id']?.length === 0"> - </span>
                      <span *ngIf="data['token_id'] === 'More'"> More </span>
                      <span class="text--primary" *ngIf="data['status'] === 'Fail'">
                        {{ data[template.matColumnDef] | stringEllipsis : 16 }}
                      </span>
                      <a
                        class="text--primary"
                        href="/tokens/{{ linkToken }}/{{ contractAddress }}?a={{ encodeData(data['token_id']) }}"
                        *ngIf="data['status'] !== 'Fail' && data['token_id'] !== 'More'">
                        {{ data[template.matColumnDef] | stringEllipsis : 16 }}
                      </a>
                    </ng-container>
                    <div *ngSwitchCase="'action'">
                      <button
                        mat-icon-button
                        aria-label="Example icon-button with a menu"
                        placement="right"
                        [ngbPopover]="popContent"
                        popoverClass="custom-popover token-popover">
                        <img [src]="'assets/images/icons/token-detail.png' | imageS3" alt="" width="16" height="16" />
                      </button>
                      <ng-template #popContent class="popContent">
                        <app-contract-popover [popoverData]="getPopoverData(data)"></app-contract-popover>
                      </ng-template>
                    </div>
                    <ng-container *ngSwitchDefault>
                      {{ data[template.matColumnDef] }}
                    </ng-container>
                  </ng-container>
                </ng-container>
              </div>
            </td>
          </ng-container>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell g-no-data" colspan="9999">
            {{ 'NO DATA' | translate }}
          </td>
        </tr>
      </table>
    </ng-container>
    <ng-template #noValues>
      <app-table-no-data></app-table-no-data>
    </ng-template>
  </div>
  <app-paginator
    [length]="pageData?.length"
    [pageSize]="pageData?.pageSize"
    (paginator)="paginatorEmit($event)"
    (pageEvent)="pageEvent($event)"></app-paginator>
</ng-container>

<div *ngIf="loading">
  <app-loading-sprint></app-loading-sprint>
</div>
